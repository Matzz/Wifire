<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Wifire</title>
<link href="bootstrap.min.css" rel="stylesheet">
<link href="main.css" rel="stylesheet">
<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
	<!-- Fixed navbar -->
	<nav class="main-navbar navbar navbar-expand-lg navbar-dark bg-primary">
		<a class="navbar-brand" href="#">Wifire</a>

		<ul class="navbar-nav">
			<li class="nav-item"><a class="nav-link" href="#editAp">Ap config</a></li>
			<li class="nav-item"><a class="nav-link" href="#editStation">Station config</a></li>
			<li class="nav-item"><a class="nav-link" href="#editGpio">GPIO config</a></li>
			<li class="nav-item"><a class="nav-link" href="#editOta">Ota config</a></li>
			<li class="nav-item"><a class="nav-link" href="#usersList">Users</a></li>
		</ul>
	</nav>
	<div class="container" id="content"></div>

	<script src="jquery.min.js"></script>
	<script src="bootstrap.min.js"></script>
	<script src="underscore.js"></script>
	<script src="app.js"></script>
	<script id="info_tpl" type="text/template">
		<table class="table">
			<% for(i in rows) { %>
				<tr>
					<th><%= i %></th>
					<td><%= rows[i] %></td>
				</tr>
			<% } %>
		</table>
	</script>
	<script id="dynamic_form_tpl" type="text/template">
		<form class="form-horizontal" id="form">
			<% if(title) { %>
				<h2><%= title %></h2>
			<% } %>
			<% for(name in inputs) { %>
			<% var input = inputs[name] %>
			<div class="form-group row">
				<label class="col-sm-2 col-form-label" for="form_<%= name %>"><%= input.label %></label>
				<div class="col-sm-10">
					<% if(input.type=="checkbox") { %>
      					<div class="form-check">
							<input
								type="checkbox"
								class="form-check-input"
								id="form_<%= name %>"
								name="<%= name %>"
								value="true"
								<%= (input.value ? "checked " : "") %>" />
						</div>
					<% } else if(input.type=="select") { %>
						<select
							type="<%= input.type %>"
							class="form-control"
							id="form_<%= name %>"
							name="<%= name %>">
						<% for(i in input.values) { %>
							<option value="<%= i %>" <%= i==input.value ? "selected=true" : "" %>>
								<%= input.values[i] %>
							</option>
						<% } %>
						</select>
					<% } else { %>
						<input
							type="<%= input.type %>"
							class="form-control"
							id="form_<%= name %>"
							name="<%= name %>"
							value="<%= input.value %>" />
					<% } %>
				</div>
			</div>
			<% } %>
			<div class="col-sm-offset-3">
  				<button type="button" class="btn btn-primary" id="form_submit">Submit</button>
			</div>
		</form>
	</script>
	<script id="gpio_tpl" type="text/template">
	<form class="form-horizontal" id="form">
	<h2>Edit GPIO configuration</h2>
	<table class="table">
		<tr>
			<th scope="col">Pin number</th>
			<th scope="col">Pin name</th>
			<th scope="col">Mode</th>
			<th scope="col">Pull up (down GPIO 16)</th>
		</tr>
		<% for(idx in response_data['gpio']) { %>
		<tr>
			<% var pin = response_data['gpio'][idx] %>
			<th>
				<%= idx %>
			</th>
			<th>
				<input type="text" name="gpio[<%= idx %>]['name']" value="<%= pin['name'] %>" />
			</th>
			<td>
				<select name="gpio[<%= idx %>]['isInput']">
					<option value="true" <%= pin['isInput'] ? 'selected' : ''  %>>
						Input
					</option>
					<option value="false" <%= !pin['isInput'] ? 'selected' : ''  %>>
						Output
					</option>
				</select>
			</td>
			<td>
				<input type="checkbox" name="gpio[<%= idx %>]['pull']" <%= pin['pull'] ? 'checked' : '' %> value="1" />
			</td>
		</tr>
		<% } %>
		</tr>
	</table>
	<div class="col-sm-offset-3">
			<button type="button" class="btn btn-primary" id="form-submit">Submit</button>
	</div>
	</form>
	</script>
	<script id="users_list_tpl" type="text/template">
		<div id="user_list_container">
			<table class="table">
				<tr>
					<th>Enabled</th>
					<th>Login</th>
					<th>Roles</th>
					<th>Actions</th>
				</tr>
				<% for(var i in data['users']) { %>
					<% var user = data['users'][i] %>
					<% var rolesStr = user['roles'].join(", ") %>
					<tr>
						<td><%= user['enabled'] %></td>
						<td><%= user['login'] %></td>
						<td><%= rolesStr %></td>
						<td>
							<a onClick="editUser(<%= user['enabled'] %>, '<%= user['login'] %>', '<%= rolesStr %>')">Edit</a>
							/
							<a onClick="deleteUser('<%= user['login'] %>')">Delete</a>
						</td>
					</tr>
				<% } %>
			</table>
			<div class="row">
				<div class="col-sm-12">
					<button type="button" class="btn btn-primary" onClick="newUser()">New user</button>
				</div>
			</div>
		</div>
		<div id="user_form_container">
			<form class="form-horizontal" id="form">
				<h2 id="user_form_title"></h2>
				<div class="form-group row">
					<label class="col-sm-2 col-form-label" for="form_enabled">Enabled</label>
					<div class="col-sm-10">
						<div class="form-check">
							<input
								type="checkbox"
								class="form-check-input"
								id="form_enabled"
								name="enabled"
								value="true"
							/>
						</div>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-2 col-form-label" for="form_login">Login</label>
					<div class="col-sm-10">
						<input
							type="text"
							class="form-text-control"
							id="form_login"
							name="login"
						/>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-2 col-form-label" for="form_roles">Roles</label>
					<div class="col-sm-10">
						<input
							type="text"
							class="form-text-control"
							id="form_roles"
							name="roles"
						/>
						<small class="form-text text-muted">Please provide coma separated list.</small>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-2 col-form-label" for="form_password">Password</label>
					<div class="col-sm-10">
						<input
							type="text"
							class="form-text-control"
							id="form_password"
							name="password"
						/>
						<small class="form-text text-muted">Please provide only if you would like to change user password.</small>
					</div>
				</div>
				<div class="row">
					<div class="offset-2 col-sm-1">
						<button type="button" class="btn btn-primary" id="user_form_submit">Submit</button>
					</div>
					<div class="col-sm-1">
						<button type="button" class="btn" id="user_form_cancel" onClick="userFormVisible(false)">Cancel</button>
					</div>
				</div>
			</form>
		</div>
	</script>
</body>
</html>